ivolkov
Волков Илья Витальевич ivolkov@t1-consulting.ru

Две задачи на spark для датасета NYC taxi.

Берем датасет за январь 2021 года

1. Для каждого дня нужно получить % поездок по количеству человек в машине (без пассажиров, 1, 2, 3 и 4 или более пассажиров) и записать результат на диск в формате parquet. Количество .parquet файлов в папке должно быть равно двум

Формат данных в выходных файлах:

date, percentage_zero, percentage_1p, percentage_2p, percentage_3p, percentage_4p_plus

01.01.2021, 1, 23, 37, 21, 18

Ex1.scala, Ex1_2var.scala. В первом варианте использовал expr(), во втором - функцию when() 

2. К предыдущим результатам добавить столбцы с самой дорогой и самой дешевой поездкой для каждой группы.

Ex2.scala, Ex2_2var.scala. В первом варианте использовал expr(), во втором - функцию when()

3. Реализовать задачу с условием вывода % поездок по количеству человек (без пассажиров, 1, 2, 3, 4, ... n)

Ex3.scala - решение, в котором используется строка с запросом, которая динамически изменяется в циклах, 
а затем выполняется в spark.sql().

Ex3_2var.scala - решение, в котором используется функциональный способ решения. Используются map, flatMap и т.д.